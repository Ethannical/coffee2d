// Generated by CoffeeScript 1.3.3
(function() {

  window.SpriteSheet = (function() {

    function SpriteSheet(filename, rowData) {
      this.filename = filename;
      this.rowData = rowData;
      this.data = [];
      this.image = new Image;
      this.image.src = this.filename;
      this.image.onload = this.onImageLoaded.bind(this);
      this.loaded = false;
    }

    SpriteSheet.prototype.onImageLoaded = function() {
      var height, i, j, row, _i, _j, _ref, _ref1;
      height = 0;
      for (i = _i = 0, _ref = this.rowData.length - 1; 0 <= _ref ? _i <= _ref : _i >= _ref; i = 0 <= _ref ? ++_i : --_i) {
        row = this.rowData[i];
        for (j = _j = 0, _ref1 = row.length - 1; 0 <= _ref1 ? _j <= _ref1 : _j >= _ref1; j = 0 <= _ref1 ? ++_j : --_j) {
          this.data.push({
            x: j * row.cellWidth,
            y: height,
            w: row.cellWidth,
            h: row.cellHeight
          });
        }
        height += row.cellHeight;
      }
      this.loaded = true;
      return Event.dispatchEvent({
        type: 'spriteImageLoaded',
        origin: this,
        target: this,
        x: 0,
        y: 0
      });
    };

    SpriteSheet.prototype.getStartFrameAndDuration = function(row) {
      var duration, i, startFrame, _i, _ref;
      startFrame = 0;
      if (row > 0) {
        for (i = _i = 0, _ref = row - 1; 0 <= _ref ? _i <= _ref : _i >= _ref; i = 0 <= _ref ? ++_i : --_i) {
          startFrame += this.rowData[i].length;
        }
      }
      duration = this.rowData[row].length;
      return {
        startFrame: startFrame,
        duration: duration
      };
    };

    SpriteSheet.prototype.getNumFrames = function() {
      return this.data.length;
    };

    return SpriteSheet;

  })();

}).call(this);
